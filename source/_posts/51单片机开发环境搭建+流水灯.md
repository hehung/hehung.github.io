---
title: 51单片机开发环境搭建+流水灯
date: 2019-11-23 9:20:30
tags: 
	- 单片机
	- C语言
	- Keil
autor: hehung
categories: 51单片机
img: https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/整体图.jpg
cover: false
coverImg: https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/整体图.jpg
top: false
summary: 使用51单片机开发套件完成了流水灯控制，能够实现8个LED的流水灯显示效果。
---

>以前在论坛上获取了一块51单片机的板子，集成了ARM+51单片机两种芯片，包括很多的外设和资料。在使用过程中写了部分教程，如果要看原贴：[点我跳转](https://bbs.icxbk.com/thread-100061-1-1.html)

# 创建51单片机工程

&emsp;&emsp;编译器选用的是keil 5，keil5相对于keil4更加的好用，同时支持stm32编程，但是keil5原始的下载安装包中是不带有51单片机的pack包的，所以需要自己在官网上下载一个C51的pack包，安装之后就可以正常给51单片机编程了。
下面开始讲解工程创建。

## 新建项目

&emsp;&emsp;如下图所示，选择Project => New jVision Project...

![新建项目](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/工程创建1.png "新建项目")

## 输入工程名字

&emsp;&emsp;选择一个路径保存你新建的工程，然后输入工程的名字，如下图所示：

![选择项目路径与名字](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/工程创建2.png "选择项目路径与名字")


## 单片机型号选择

&emsp;&emsp;选择单片机的型号，如下图，选择AT89C52，如果用的是STC89系列的51单片机，也需要选择这个，因为编译器里面没有STC89C51的选项，并且这里的操作方式和使用MDK4的时候是不一样的。

![选择单片机型号](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/选择单片机型号.png "选择单片机型号")

## 新建一个空白文件

&emsp;&emsp;点击下图所示的图标，新建一个空白编辑界面，这个就是要用到的.c文件。

![新建一个空白文件](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/新建一个空白文件.png "新建一个空白文件")

## 另存为.c文件

&emsp;&emsp;点击另存为，给新建的空杯文件输入一个名字，注意：名字后面的.c不要漏写。等会写的代码就会存放在这个文件里面，一般与工程保存在同一个文件目录下。

![另存为空白文件](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/给文件改名.png "另存为空白文件")

## 将.c文件加入工程

&emsp;&emsp;新建的空白文件还没有加入到工程中，所以需要将该文件加入到工程中，如下图所示，双击Source Group，在弹出的选择框中选择新建的.c文件

![将新建文件加入工程](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/将新建文件加入工程.png "将新建文件加入工程")

# 代码编辑与下载

## 程序编写
&emsp;&emsp;文件加入工程之后就是编写代码了。

&emsp;&emsp;因为给单片机编程是要根据你的单片机电路的实际布局来编写的，因为我的单片机的8路LED都是接在P0口上的，所以在程序中用P0来控制LED的亮灭。

``` C
#include <reg52.h>

#define uchar unsigned char
#define uint unsigned int

//写一个延时函数
void delay(uint ms)
{
    uchar i;
    for(;ms>0;ms--)
        for(i=110;i>0;i--);
}

int main()
{
    uchar kk = 0x01;
    
    P0 = kk;		
    while(1)
    {
        kk <<= 1;        //左移，如果右移可以改为kk >>= 1;
        if(kk == 0)
        {
            kk = 0x01;
        }
        
        P0 = kk;
        delay(1000);
    }
}
```

&emsp;&emsp;程序编写完成之后就是编译了，顺利编译通过就表示没有语法错误了，现在开始下一步，生成hex文件。

## hex文件生成

&emsp;&emsp;如下图所示。选择该图标，在弹出的对话框中选择Output，将创建HEX文件的对话框前面打上对勾，这样再次编译工程之后就可以在指定目录下生成一个.hex文件。这是一种16进制的文件，直接下载到单片机中运行即可。

![选择生成hex文件](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/选择生成hex文件.png "选择生成hex文件")

## 下载软件到单片机

&emsp;&emsp;打开stc-isp-15xx-v6.86F.exe软件，选择相应的单片机型号，我这里得单片机是89C516，这块单片机我以前都没见过，试了很多种型号的都下载不了，最后在89c58里面才找到这个型号。

![使用工具下载软件](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/使用工具下载软件.png "使用工具下载软件")

如果使用同样型号的单片机的小伙伴可以看下图：

![单片机型号选择](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/单片机型号选择.png "单片机型号选择")

# 运行效果

&emsp;&emsp;将程序下载到单片机之后就可以查看运行效果了，如下图所示：

![运行效果](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/运行效果.gif "运行效果")

&emsp;&emsp;附上我的接线图

![插线连接](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51单片机建工程+流水灯/插线连接.jpg "插线连接")









