---
title: 51单片机驱动步进电机
date: 2019-11-23 17:17:20
tags: 
        - 单片机
        - C语言
        - 步进电机
autor: hehung
categories: 51单片机
img: https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51-stepper_motor/display2.jpg
cover: false
coverImg: https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51-stepper_motor/display2.jpg
top: false
summary: 51单片机对步进电机的控制，步进电机的最大特点就是速度可控和步数精确，可以实现很慢的转速，对于精确转速和位置控制的设备可以使用。
---

>拿到开发板还没有使用过电机与步进电机呢，但是电机的控制太简单了，在这里就不演示了，直接用IO口的高低电平就可以正常控制了，所以就来操作一下稍微难一点而的步进电机。以前发帖在电子芯巴克。原帖子链接：[点我跳转](https://bbs.icxbk.com/thread-100298-1-1.html)

# 原理图

&emsp;&emsp;首先查看原理图。

![原理图](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51-stepper_motor/Stepper_motor_Schematic.png "原理图")

&emsp;&emsp;从上面的原理图中可以看出，该步进电机是四线双极性步进电机，需要四根线控制。

&emsp;&emsp;在开发板上的接线图如下所示：

![线路连接](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51-stepper_motor/connect_to_micro_controller.jpg "线路连接")

# 步进电机控制方式

&emsp;&emsp;这种步进电机可以正反转运动，同时还有三种控制方式：

1.单相四拍通电驱动时序
正转： A- B  A  B- 
反转： B-  A  B  A-

2.双相通电四拍驱动时序
正转：A-B   AB   AB-  A-B-
反转：A-B-  AB-  AB   A-B

3.半步八拍驱动时序
反转：A-  A-B  B  AB  A  AB-  B-  A-B-
正转：A-B-  B-  AB-  A  AB  B  A-B  A-

&emsp;&emsp;上面的控制原理中，A，A_，B，B_分别表示4根控制线。


# 程序编写

&emsp;&emsp;下面是主要代码。

## 单相四拍控制方式

是单相四拍方式,反转（逆时针），如果想正转，安装上方的工作顺序自行切换就可以了。

``` C
#include "reg52.h"                        


#define uchar unsigned char 
#define uint  unsigned int

sbit SA = P1^0;
sbit SA_ = P1^1;
sbit SB = P1^2;
sbit SB_ = P1^3;         

#define time 2000 

void step_Motor(void);
void delay(uint ms);
void step_Motor2(void);
void step_Motor3(void);

void main()
{        
        
        while(1)
        {        
                step_Motor();                
        }
}

void step_Motor(void)
{
        SA = 1;
        SA_ = 0;
        SB = 1;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 1;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 0;
        SA_ = 1;
        SB = 1;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 1;
        SB = 0;
        SB_ = 1;
        delay(time);
}
```

## 双相通电四拍驱动时序
&emsp;&emsp;如下，只提供主要操作代码
``` C
void step_Motor2(void)
{
        SA = 1;
        SA_ = 0;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 0;
        SA_ = 1;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 0;
        SA_ = 1;
        SB = 0;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 0;
        SB = 0;
        SB_ = 1;
        delay(time);
}
```

## 半步八拍（正转，顺时针）

&emsp;&emsp;如下，只提供主要操作代码

``` C
void step_Motor3(void)
{
        SA = 1;
        SA_ = 0;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 1;
        SA_ = 1;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 0;
        SA_ = 1;
        SB = 1;
        SB_ = 0;
        delay(time);

        SA = 0;
        SA_ = 1;
        SB = 1;
        SB_ = 1;
        delay(time);
        
        SA = 0;
        SA_ = 1;
        SB = 0;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 1;
        SB = 0;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 0;
        SB = 0;
        SB_ = 1;
        delay(time);

        SA = 1;
        SA_ = 10;
        SB = 1;
        SB_ = 1;
        delay(time);
}

```

## 注意事项

+ <font color=red>值得注意的是，如果你的步进电机的相序出错的话就会造成左右都懂，这样就要检查一下你的相序是不是对的</font>。
+ 温馨提示：步进电机运行久了会很烫，不要用手直接触碰
+ 对步进电机的调速，可以通过每步之间的延时来达到，延时越长，运动越慢。

# 运行结果

&emsp;&emsp;示效果的时间到了。从动图中可以看到转的很慢，但是实际上转的比这个快一些，主要是动图丢帧比较严重.

![运行结果](https://cdn.jsdelivr.net/gh/hehung/cdn-jsDelivr-hehung-blog-sources/51-stepper_motor/display.gif "运行结果")


