// build time:Sun Dec 01 2019 15:30:20 GMT+0800 (GMT+08:00)
(function(e){"use strict";var t=e.document.documentElement,s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},i=s[Modernizr.prefixed("transition")],r={transitions:Modernizr.csstransitions,support3d:Modernizr.csstransforms3d};function n(e,t){e.style.WebkitTransform=t;e.style.msTransform=t;e.style.transform=t}function o(){var s=t["clientWidth"],i=e["innerWidth"];if(s<i)return i;else return s}function a(e,t){for(var s in t){if(t.hasOwnProperty(s)){e[s]=t[s]}}return e}function l(e,t){this.el=e;this.options=a({},this.options);a(this.options,t);this._init()}l.prototype.options={};l.prototype._init=function(){this.grid=this.el.querySelector("section.grid-wrap > ul.grid");this.gridItems=[].slice.call(this.grid.querySelectorAll("li:not(.grid-sizer)"));this.itemsCount=this.gridItems.length;this.slideshow=this.el.querySelector("section.slideshow > ul");this.slideshowItems=[].slice.call(this.slideshow.children);this.current=-1;this.ctrlPrev=this.el.querySelector("section.slideshow > nav > span.nav-prev");this.ctrlNext=this.el.querySelector("section.slideshow > nav > span.nav-next");this.ctrlClose=this.el.querySelector("section.slideshow > nav > span.nav-close");this._initMasonry();this._initEvents()};l.prototype._initMasonry=function(){var e=this.grid;imagesLoaded(e,function(){new Masonry(e,{itemSelector:"li",columnWidth:e.querySelector(".grid-sizer")})})};l.prototype._initEvents=function(){var s=this;this.gridItems.forEach(function(e,t){e.addEventListener("click",function(){s._openSlideshow(t)})});this.ctrlPrev.addEventListener("click",function(){s._navigate("prev")});this.ctrlNext.addEventListener("click",function(){s._navigate("next")});this.ctrlClose.addEventListener("click",function(){s._closeSlideshow()});e.addEventListener("resize",function(){s._resizeHandler()});document.addEventListener("keydown",function(e){if(s.isSlideshowVisible){var t=e.keyCode||e.which;switch(t){case 37:s._navigate("prev");break;case 39:s._navigate("next");break;case 27:s._closeSlideshow();break}}});e.addEventListener("scroll",function(){if(s.isSlideshowVisible){e.scrollTo(s.scrollPosition?s.scrollPosition.x:0,s.scrollPosition?s.scrollPosition.y:0)}else{s.scrollPosition={x:e.pageXOffset||t.scrollLeft,y:e.pageYOffset||t.scrollTop}}})};l.prototype._openSlideshow=function(e){this.isSlideshowVisible=true;this.current=e;classie.addClass(this.el,"slideshow-open");this._setViewportItems();classie.addClass(this.currentItem,"current");classie.addClass(this.currentItem,"show");if(this.prevItem){classie.addClass(this.prevItem,"show");var t=Number(-1*(o()/2+this.prevItem.offsetWidth/2));n(this.prevItem,r.support3d?"translate3d("+t+"px, 0, -150px)":"translate("+t+"px)")}if(this.nextItem){classie.addClass(this.nextItem,"show");var t=Number(o()/2+this.nextItem.offsetWidth/2);n(this.nextItem,r.support3d?"translate3d("+t+"px, 0, -150px)":"translate("+t+"px)")}};l.prototype._navigate=function(e){if(this.isAnimating)return;if(e==="next"&&this.current===this.itemsCount-1||e==="prev"&&this.current===0){this._closeSlideshow();return}this.isAnimating=true;this._setViewportItems();var t=this,s=this.currentItem.offsetWidth,a=r.support3d?"translate3d(-"+Number(o()/2+s/2)+"px, 0, -150px)":"translate(-"+Number(o()/2+s/2)+"px)",l=r.support3d?"translate3d("+Number(o()/2+s/2)+"px, 0, -150px)":"translate("+Number(o()/2+s/2)+"px)",h="",c,u,m;if(e==="next"){c=r.support3d?"translate3d( -"+Number(o()*2/2+s/2)+"px, 0, -150px )":"translate(-"+Number(o()*2/2+s/2)+"px)";u=r.support3d?"translate3d( "+Number(o()*2/2+s/2)+"px, 0, -150px )":"translate("+Number(o()*2/2+s/2)+"px)"}else{c=r.support3d?"translate3d( "+Number(o()*2/2+s/2)+"px, 0, -150px )":"translate("+Number(o()*2/2+s/2)+"px)";u=r.support3d?"translate3d( -"+Number(o()*2/2+s/2)+"px, 0, -150px )":"translate(-"+Number(o()*2/2+s/2)+"px)"}classie.removeClass(t.slideshow,"animatable");if(e==="next"&&this.current<this.itemsCount-2||e==="prev"&&this.current>1){m=this.slideshowItems[e==="next"?this.current+2:this.current-2];n(m,u);classie.addClass(m,"show")}var d=function(){classie.addClass(t.slideshow,"animatable");classie.removeClass(t.currentItem,"current");var s=e==="next"?t.nextItem:t.prevItem;classie.addClass(s,"current");n(t.currentItem,e==="next"?a:l);if(t.nextItem){n(t.nextItem,e==="next"?h:c)}if(t.prevItem){n(t.prevItem,e==="next"?c:h)}if(m){n(m,e==="next"?l:a)}var o=function(s){if(r.transitions){if(s.propertyName.indexOf("transform")===-1)return false;this.removeEventListener(i,o)}if(t.prevItem&&e==="next"){classie.removeClass(t.prevItem,"show")}else if(t.nextItem&&e==="prev"){classie.removeClass(t.nextItem,"show")}if(e==="next"){t.prevItem=t.currentItem;t.currentItem=t.nextItem;if(m){t.nextItem=m}}else{t.nextItem=t.currentItem;t.currentItem=t.prevItem;if(m){t.prevItem=m}}t.current=e==="next"?t.current+1:t.current-1;t.isAnimating=false};if(r.transitions){t.currentItem.addEventListener(i,o)}else{o()}};setTimeout(d,25)};l.prototype._closeSlideshow=function(e){classie.removeClass(this.el,"slideshow-open");classie.removeClass(this.slideshow,"animatable");var t=this,s=function(e){if(r.transitions){if(e.target.tagName.toLowerCase()!=="ul")return;this.removeEventListener(i,s)}classie.removeClass(t.currentItem,"current");classie.removeClass(t.currentItem,"show");if(t.prevItem){classie.removeClass(t.prevItem,"show")}if(t.nextItem){classie.removeClass(t.nextItem,"show")}t.slideshowItems.forEach(function(e){n(e,"")});t.isSlideshowVisible=false};if(r.transitions){this.el.addEventListener(i,s)}else{s()}};l.prototype._setViewportItems=function(){this.currentItem=null;this.prevItem=null;this.nextItem=null;if(this.current>0){this.prevItem=this.slideshowItems[this.current-1]}if(this.current<this.itemsCount-1){this.nextItem=this.slideshowItems[this.current+1]}this.currentItem=this.slideshowItems[this.current]};l.prototype._resizeHandler=function(){var e=this;function t(){e._resize();e._resizeTimeout=null}if(this._resizeTimeout){clearTimeout(this._resizeTimeout)}this._resizeTimeout=setTimeout(t,50)};l.prototype._resize=function(){if(this.isSlideshowVisible){if(this.prevItem){var e=Number(-1*(o()/2+this.prevItem.offsetWidth/2));n(this.prevItem,r.support3d?"translate3d("+e+"px, 0, -150px)":"translate("+e+"px)")}if(this.nextItem){var e=Number(o()/2+this.nextItem.offsetWidth/2);n(this.nextItem,r.support3d?"translate3d("+e+"px, 0, -150px)":"translate("+e+"px)")}}};e.CBPGridGallery=l})(window);
//rebuild by neat 